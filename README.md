# AI Health Coach

Flutter app for adaptive rehab workouts with AI-generated plans.

## Requirements

### Core
- Git
- Flutter SDK `3.38.4` (stable)
- Dart SDK `3.10.3` (from `pubspec.yaml: environment.sdk: ^3.10.3`)

### Android toolchain
- Android Studio (latest stable)
- Android SDK + platform-tools installed in Android Studio SDK Manager
- JDK `17` (project uses Java/Kotlin target 17)
- Gradle wrapper `8.14` (already configured in repo)
- Android Gradle Plugin `8.11.1` (already configured in repo)
- Kotlin plugin `2.2.20` (already configured in repo)

### iOS toolchain (if you build for iOS/macOS)
- macOS
- Xcode 15+
- CocoaPods
- iOS deployment target: `13.0`

### Verify local setup
```bash
flutter --version
flutter doctor -v
java -version
```

## Clone Project

```bash
git clone https://github.com/Beksh0800/AI-HealthCoach.git
cd ai_health_coach
```

## Install Dependencies

```bash
flutter pub get
```

## Environment Variables (`.env`)

Create `.env` in the project root (this file is ignored by git):

```dotenv
# Required (primary AI provider)
OPENROUTER_API_KEY=your_openrouter_api_key

# Optional (fallback AI provider)
GEMINI_API_KEY=your_gemini_api_key

# Optional tuning
OPENROUTER_FAST_MODE=true
OPENROUTER_FAST_MODEL=openai/gpt-4o-mini
OPENROUTER_MODELS=openai/gpt-4o-mini,google/gemini-2.0-flash-001,anthropic/claude-3.5-haiku,meta-llama/llama-3.3-70b-instruct,openrouter/auto
OPENROUTER_MAX_MODEL_ATTEMPTS=2
OPENROUTER_TIMEOUT_SECONDS=22
```

Current app behavior:
- OpenRouter is the primary provider
- Gemini is fallback when configured

## Firebase Setup

Project already contains:
- `lib/firebase_options.dart` (generated by FlutterFire CLI)
- `android/app/google-services.json`

For iOS, add Firebase config file if needed:
- `ios/Runner/GoogleService-Info.plist`

If you use your own Firebase project, regenerate config:
```bash
dart pub global activate flutterfire_cli
flutterfire configure
```

## Run App

```bash
flutter run
```

Run on a specific device:
```bash
flutter devices
flutter run -d <device_id>
```

## Build Release (Android)

### 1) Configure signing

Create `android/key.properties`:

```properties
storePassword=your_store_password
keyPassword=your_key_password
keyAlias=your_key_alias
storeFile=../your-upload-keystore.jks
```

`android/key.properties` and keystore files are ignored by git.

### 2) Build using helper script

```powershell
./tool/build_release.ps1 -BuildName 1.0.1 -BuildNumber 2
```

Output:
- AAB: `build/app/outputs/bundle/release/app-release.aab`
- APKs: `build/app/outputs/flutter-apk`
- Symbols: `build/symbols`

The script also renames split APKs to:
- `ai-health-coach-<buildName>+<buildNumber>-<abi>.apk`

### 3) Manual release build (optional)

```bash
flutter build appbundle --release --obfuscate --split-debug-info=build/symbols
flutter build apk --release --obfuscate --split-debug-info=build/symbols --split-per-abi
```

## Troubleshooting

- `OpenRouter request timed out`
  - Reduce load with `OPENROUTER_FAST_MODE=true`
  - Lower attempts with `OPENROUTER_MAX_MODEL_ATTEMPTS=1`
  - Increase timeout with `OPENROUTER_TIMEOUT_SECONDS=30`

- `Unable to resolve host firestore.googleapis.com`
  - Usually network/DNS issue on device; if internet is disabled during testing, this is expected.

- `Invalid image data` for `NetworkImage`
  - Do not pass non-image URLs (for example, YouTube search pages) into `NetworkImage`.
  - Use direct image URLs (PNG/JPG/WebP) or local asset placeholders.

## Useful Commands

```bash
flutter clean
flutter pub get
flutter analyze
flutter test
```
